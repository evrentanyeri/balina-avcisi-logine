// Balina AvcÄ±sÄ± - CanlÄ± RSI & Hacim & Pump Sinyalleri
// CoinGecko'dan en popÃ¼ler coinleri Ã§eker

const table = document.getElementById("signalTable");

async function fetchSignals() {
  try {
    const response = await fetch(
      "https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=volume_desc&per_page=20&page=1&sparkline=false"
    );
    const data = await response.json();

    table.innerHTML = ""; // tabloyu temizle

    data.forEach((coin, index) => {
      const change = coin.price_change_percentage_24h?.toFixed(2) || 0;
      const volume = (coin.total_volume / 1_000_000).toFixed(1); // Milyon USD

      // Pump sinyali mantÄ±ÄŸÄ±
      let signal = "";
      if (change > 5 && volume > 50) signal = "ğŸš€ Pump";
      else if (change < -5) signal = "ğŸ”» DÃ¼ÅŸÃ¼ÅŸ";
      else signal = "âšª NÃ¶tr";

      const row = `
        <tr>
          <td>${index + 1}</td>
          <td>${coin.symbol.toUpperCase()}</td>
          <td>$${coin.current_price.toFixed(4)}</td>
          <td style="color:${change > 0 ? "lime" : "red"}">${change}%</td>
          <td>${volume}M</td>
          <td>${signal}</td>
        </tr>
      `;
      table.innerHTML += row;
    });
  } catch (error) {
    table.innerHTML = `<tr><td colspan="6" class="text-center text-danger">Veri alÄ±namadÄ± âŒ</td></tr>`;
    console.error("Hata:", error);
  }
}

// 20 saniyede bir yenile
fetchSignals();
setInterval(fetchSignals, 20000);
